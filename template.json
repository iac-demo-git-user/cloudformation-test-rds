{
  "AWSTemplateFormatVersion" : "2010-09-09",
  "Description" : "A sample template",
    "Resources": {
        "RestApi": {
            "Type": "AWS::ApiGateway::RestApi",
            "Properties": {
                "Name": "myApi",
                "Parameters": {
                    "endpointConfigurationTypes": "REGIONAL"
                }
            }
        },
        
        "MockMethod": {
        "Type": "AWS::ApiGateway::Method",
        "Properties": {
            "RestApiId": {
                "Ref": "RestApi"
            },
            "ResourceId": {
                "Fn::GetAtt": [
                    "RestApi",
                    "RootResourceId"
                ]
            },
            "HttpMethod": "GET",
            "AuthorizationType": "NONE",
            "Integration": {
                "Type": "MOCK"
            }
        }
    },
    
    "TestClientCertificate": {
        "Type": "AWS::ApiGateway::ClientCertificate",
        "Properties": {
            "Description": "A test client certificate"
        }
    },
    
    "dev": {
            "Type": "AWS::ApiGateway::Stage",
            "Properties": {
                "StageName": "Prod",
                "Description": "Prod Stage",
                "RestApiId": {
                    "Ref": "RestApi"
                },
                "DeploymentId": {
                    "Ref": "TestDeployment"
                },
                "ClientCertificateId": {
                    "Ref": "TestClientCertificate"
                },
                "Variables": {
                    "Stack": "Prod"
                },
                "MethodSettings": [
                    {
                        "ResourcePath": "/",

                        "HttpMethod": "GET",
                        "MetricsEnabled": "true",
                        "DataTraceEnabled": "false"
                    }
                ]
            }
        },
        "TestDeployment": {
        "Type": "AWS::ApiGateway::Deployment",
        "DependsOn":"MockMethod",
        "Properties": {
            "RestApiId": {
                "Ref": "RestApi"
            },
            "Description": "My deployment",
            "StageName": "dev"
        }
    }
  }
}
